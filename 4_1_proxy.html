<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>简单的响应式</title>
</head>
<body>
<div id="app"></div>
</body>
<script lang="ts">


// 响应式数据
const obj1 = {text:'hello world'}


obj1.text = 'hello vue3' //修改obj.text的值，同时希望副作用函数会重新执行

// 副作用函数，effect函数的执行可以直接或间接的影响其他函数的执行，我们就说effect产生了副作用 
function effect(){
  document.body.innerText = obj1.text
}





const bucket = new Set() //存储effect函数的容器

const data = {text: 'hello world'}
const obj = new Proxy(data, {
  get(target, key){
    bucket.add(effect1)
    return Reflect.get(target, key)
  },
  set(target, key, value){

    const result = Reflect.set(target, key, value)
    bucket.forEach(effect => effect())
    return result
  }
})
function effect1(){
  document.body.innerText = obj.text
}

effect1() //执行effect1函数
setTimeout(() => {
  obj.text = 'hello 我是vue3'
}, 1000)

</script>
</html>